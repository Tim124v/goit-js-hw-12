{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport class PixabayAPI {\n  #BASE_URL = 'https://pixabay.com/api/';\n  #API_KEY = '49429251-c344791abe1bae313073c39aa';\n\n  constructor() {\n    this.page = 1;\n    this.query = '';\n    this.per_page = 15;\n  }\n\n  async fetchImages() {\n    try {\n      const params = {\n        key: this.#API_KEY,\n        q: this.query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: this.page,\n        per_page: this.per_page,\n      };\n\n      const response = await axios.get(this.#BASE_URL, { params });\n      return response.data;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n}\n","export function createMarkup(images) {\n  if (!Array.isArray(images)) return '';\n  \n  return images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n    <li class=\"photo-card\">\n      <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes</b>\n          ${likes}\n        </p>\n        <p class=\"info-item\">\n          <b>Views</b>\n          ${views}\n        </p>\n        <p class=\"info-item\">\n          <b>Comments</b>\n          ${comments}\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads</b>\n          ${downloads}\n        </p>\n      </div>\n    </li>\n  `).join('');\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { PixabayAPI } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions.js';\n\nconst refs = {\n    form: document.querySelector('.form'),\n    gallery: document.querySelector('.gallery'),\n    loadMore: document.querySelector('.load-more'),\n    loader: document.querySelector('.loader')\n};\n\nconst pixabayAPI = new PixabayAPI();\nconst lightbox = new SimpleLightbox('.gallery a');\n\nfunction showToast(message, type = 'error') {\n    iziToast.show({\n        message,\n        messageColor: '#FFFFFF',\n        position: 'topRight',\n        timeout: 3000,\n        close: false,\n        backgroundColor: type === 'error' ? '#EF4040' : '#4CAF50'\n    });\n}\n\nfunction showLoader() {\n    refs.loader.textContent = 'Loading images, please wait...';\n    refs.loader.classList.remove('is-hidden');\n}\n\nfunction removeLoader() {\n    refs.loader.textContent = '';\n    refs.loader.classList.add('is-hidden');\n}\n\nasync function onSubmit(e) {\n    e.preventDefault();\n    const searchQuery = e.currentTarget.elements.searchQuery.value.trim();\n    if (!searchQuery) {\n        showToast('Please enter a search query');\n        return;\n    }\n\n    pixabayAPI.query = searchQuery;\n    pixabayAPI.resetPage();\n    refs.gallery.innerHTML = '';\n    refs.loadMore.classList.add('is-hidden');\n    showLoader();\n\n    try {\n        const { hits, totalHits } = await pixabayAPI.fetchImages();\n        if (hits.length === 0) {\n            showToast('Sorry, there are no images matching your search query. Please try again.');\n            return;\n        }\n\n        refs.gallery.innerHTML = createMarkup(hits);\n        lightbox.refresh();\n\n        showToast(`Hooray! We found ${totalHits} images.`, 'success');\n\n        if (hits.length < totalHits) {\n            refs.loadMore.classList.remove('is-hidden');\n        }\n        \n        refs.form.reset();\n    } catch (error) {\n        showToast('Something went wrong. Please try again.');\n    } finally {\n        removeLoader();\n    }\n}\n\nasync function onLoadMore() {\n    pixabayAPI.incrementPage();\n    refs.loadMore.classList.add('is-hidden');\n    showLoader();\n\n    try {\n        const { hits, totalHits } = await pixabayAPI.fetchImages();\n        refs.gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n        lightbox.refresh();\n\n        const totalPages = Math.ceil(totalHits / pixabayAPI.per_page);\n        if (pixabayAPI.page >= totalPages) {\n            refs.loadMore.classList.add('is-hidden');\n            showToast(\"We're sorry, but you've reached the end of search results.\", 'error');\n        } else {\n            refs.loadMore.classList.remove('is-hidden');\n        }\n\n        const { height: cardHeight } = refs.gallery\n            .firstElementChild\n            .getBoundingClientRect();\n\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth',\n        });\n    } catch (error) {\n        showToast('Something went wrong. Please try again.');\n    } finally {\n        removeLoader();\n    }\n}\n\nrefs.form.addEventListener('submit', onSubmit);\nrefs.loadMore.addEventListener('click', onLoadMore);\n"],"names":["PixabayAPI","__privateAdd","_BASE_URL","_API_KEY","params","__privateGet","axios","error","createMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","pixabayAPI","lightbox","SimpleLightbox","showToast","message","type","iziToast","showLoader","removeLoader","onSubmit","e","searchQuery","hits","totalHits","onLoadMore","totalPages","cardHeight"],"mappings":"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"}